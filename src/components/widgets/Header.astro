---
import { ShoppingBag, Menu } from '@lucide/astro';
---

<header class="bg-white">
  <div class="container mx-auto flex h-16 items-center gap-8 px-4 sm:px-6 lg:px-8">
    <a class="flex items-center text-teal-600" href="/">
      <span class="sr-only">Home</span>
      <ShoppingBag class="h-8 w-8 mr-2" />
      <span class="font-bold text-lg text-gray-900">DIPLOSTORE</span>
    </a>

    <div class="flex flex-1 items-center justify-end md:justify-between">
      <nav aria-label="Global" class="hidden md:block" id="desktop-menu">
        <ul class="flex items-center gap-6 text-sm">
          <li>
            <a class="text-gray-500 transition hover:text-gray-500/75" href="/"> Inicio </a>
          </li>

          <li>
            <a class="text-gray-500 transition hover:text-gray-500/75" href="/productos"> Productos </a>
          </li>

          <!-- <li>
            <a class="text-gray-500 transition hover:text-gray-500/75" href="/contacto"> Contacto </a>
          </li> -->
        </ul>
      </nav>

      <div class="flex items-center gap-4">
        <div class="sm:flex sm:gap-4">
          <center>
            <a
            class="block rounded-md bg-teal-600 px-5 py-2.5 break-normal text-sm font-medium text-white transition hover:bg-teal-700"
            href="/login"
          >
            Iniciar sesión
          </a>
          </center>

          <a
            class="hidden rounded-md bg-gray-100 px-5 py-2.5 text-sm font-medium text-teal-600 transition hover:text-teal-600/75 sm:block"
            href="/registro"
          >
            Registrarse
          </a>
        </div>

        <button
          class="block rounded-sm bg-gray-100 p-2.5 text-gray-600 transition hover:text-gray-600/75 md:hidden"
          id="toggle-menu"
          aria-expanded="false"
          aria-controls="mobile-menu-dropdown"
        >
          <span class="sr-only">Toggle menu</span>
          <Menu class="h-5 w-5" />
        </button>
      </div>
    </div>
  </div>
</header>

<div class="md:hidden bg-white w-full absolute z-10 shadow-md hidden" id="mobile-menu-dropdown">
  <ul class="py-4 px-6 space-y-4">
    <li>
      <a class="text-gray-500 transition hover:text-gray-500/75" href="/"> Inicio </a>
    </li>
    <li>
      <a class="text-gray-500 transition hover:text-gray-500/75" href="/productos"> Productos </a>
    </li>
    <li>
      <a class="text-gray-500 transition hover:text-gray-500/75" href="/contacto"> Contacto </a>
    </li>
  </ul>
  <div class="px-6 py-4 border-t border-gray-100">
    <!-- <a
      class="block w-full rounded-md bg-teal-600 px-5 py-2.5 text-center text-sm font-medium text-white transition hover:bg-teal-700 mb-2"
      href="#"
    >
      Iniciar sesión
    </a> -->
    <a
      class="block w-full rounded-md bg-gray-100 px-5 py-2.5 text-center text-sm font-medium text-teal-600 transition hover:text-teal-600/75"
      href="/registro"
    >
      Registrarse
    </a>
  </div>
</div>

<script is:inline>
  function initMobileMenu() {
    const toggleButton = document.getElementById('toggle-menu');
    const mobileMenuDropdown = document.getElementById('mobile-menu-dropdown');

    if (toggleButton && mobileMenuDropdown) {
      toggleButton.addEventListener('click', () => {
        mobileMenuDropdown.classList.toggle('hidden');
        const isExpanded = mobileMenuDropdown.classList.contains('hidden') ? 'false' : 'true';
        toggleButton.setAttribute('aria-expanded', isExpanded);
      });

      document.addEventListener('click', (event) => {
        if (!toggleButton.contains(event.target) && !mobileMenuDropdown.contains(event.target)) {
          mobileMenuDropdown.classList.add('hidden');
          toggleButton.setAttribute('aria-expanded', 'false');
        }
      });

      window.addEventListener('resize', () => {
        if (window.innerWidth >= 768) {
          mobileMenuDropdown.classList.add('hidden');
          toggleButton.setAttribute('aria-expanded', 'false');
        }
      });
    }
  }

  initMobileMenu();

  document.addEventListener('astro:after-swap', initMobileMenu);
</script>

